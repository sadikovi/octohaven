(function(){var e,t,n,o,i,r,a,s,d,l,m,c,u,h,p,b,g,f,v,w,y,j;if(p=document.getElementById("octohaven-timetable-create"),o=document.getElementById("octohaven-cron-help"),!p||!o)throw new Error("Timetable placeholders are not found");if(f=this.mapper,j=this.util,v=this.misc,w=this.namer,g=new this.JobApi,y=new this.TimetableApi,s=j.windowParameters(),a=null!=s?s.mode:void 0,r=null!=s?s.id:void 0,"create"!==a)return b=v.blankslateWithMsg("Something went wrong :(","Unrecognized mode"),void f.parseMapForParent(b,p);if(!r)return b=v.blankslateWithMsg("Something went wrong :(","Undefined id"),void f.parseMapForParent(b,p);if(n=document.getElementById("octohaven-create-controls"),u=document.getElementById("octohaven-submit-timetable"),c=document.getElementById("octohaven-validation-status"),!(n&&c&&u))throw new Error("Submit requirements failed");t=!1,e=new this.Timetable({name:"Timetable "+w.generate(),pattern:"",jobid:"",jobname:"Undefined"}),i=e,d=function(e){return e?j.addClass(c,"loading"):j.removeClass(c,"loading")},l=function(e,t){var n;return c.innerHTML="",a=e?"success-box":"error-box",n={type:"div",cls:a,children:t},f.parseMapForParent(n,c)},m=function(e,t){return l(e,{type:"span",title:""+t})},h=function(e){var n;return d(!0),t?(m(!1,"You cannot resubmit the timetable"),d(!1)):(t=!0,n=e.settings,y.submit(n,null,function(e,n){var o,i,r;return d(!1),e?(i=n.content.msg,r=n.content.uid,o={type:"span",title:i+". ",children:{type:"a",title:"View details",href:"/timetable?id="+r+"&mode=show"}},l(e,o)):(t=!1,i=n?n.content.msg:"Something went wrong :(",m(e,i))}))},j.addEventListener(u,"click",function(e){return h(i),e.preventDefault(),e.stopPropagation()}),g.getJob(r,function(){return p.innerHTML=""},function(e,t){var r,a,s,d,l,m;return l=null,e?(j.removeClass(n,"hidden"),j.removeClass(c,"hidden"),j.removeClass(o,"hidden"),r=t.content.job,a=r.uid,s=r.sparkjob.name,i.set("jobid",a),i.set("jobname",s),m=[v.staticOption("Clone job","Base job for timetable",{type:"a",href:"/job?jobid="+a,title:""+s}),v.dynamicOption("Name","Timetable name",""+i.get("name"),function(e,t){return e?i.set("name",t):void 0}),v.dynamicOption("Cron pattern","Cron expression for scheduling",""+i.get("pattern"),function(e,t){return e?i.set("pattern",t):void 0})],l=v.segments(m)):(d=t?t.content.msg:"We know and keep working on that",l=v.blankslateWithMsg("Something went wrong :(",d)),f.parseMapForParent(l,p)})}).call(this);