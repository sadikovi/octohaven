(function(){var e,t,n,r,o,i,c,l,s,d,u,a,p,h,m,v,f,y,b,E,g,C,j,L,k,I,w,x,M,B;if(v=document.getElementById("octohaven-jobs-history"),!v)throw new Error("Job history element could not be found");B=this.util,w=this.mapper,I=this.loader,x=this.misc,k=new this.JobApi,M=["ALL","CREATED","FINISHED","WAITING","CLOSED","DELAYED","RUNNING"],e=M[0],n=M[1],o=M[2],c=M[3],t=M[4],r=M[5],i=M[6],j=function(e,t,n){var r,o,i,c,l;return null==n&&(n=!1),l=n?"one-third column":"one-sixth column",c={type:"span",cls:""+t,title:""+e},i={type:"div",cls:"section",children:c},o={type:"div",cls:"breadcrumb",children:i},r={type:"div",cls:""+l,children:o},w.parseMapForParent(r)},d=function(e,t,n){var r,o,i;return null==n&&(n=!1),i=n?"one-third column":"one-sixth column",r={type:"div",cls:"btn btn-compact",title:""+e,onclick:function(e){return"function"==typeof t?t(this):void 0}},o={type:"div",cls:""+i,children:r},w.parseMapForParent(o)},m=function(e,t,n,r){var o,i,c,l,s,d,u,a,p;return o="two-thirds column",s={type:"a",href:""+t,title:""+e},u={type:"span",cls:"text-mute",title:"@Spark"},d={type:"div",cls:"section",children:[s,u]},a={type:"span",cls:"text-mute",title:""+n},i={type:"span",title:""+B.humanReadableTime(r)},p={type:"div",cls:"section",children:[a,i]},l={type:"div",cls:"breadcrumb",children:[d,p]},c={type:"div",cls:""+o,children:l},w.parseMapForParent(c)},C=function(e){return e===n?"text-green":e===c?"text-yellow":e===i?"text-teal":e===o?"text-blue":e===t?"text-red":"text-mute"},b=function(e){var t,o,i,l,s,u,a,p,h,v;return v=e.uid,h=e.createtime,a=e.status,l=e.sparkjob.name,i=m(l,"/job?jobid="+v,"Created ",h),u=a===n||a===r||a===c,p=j(a,C(a),!u),t=d("Close",function(e){var t,n;return null==e.uid&&(e.uid=v),t=function(t){return function(){return B.addClass(e,"btn-disabled"),e.innerHTML="???"}}(this),n=function(t){return function(t){return B.addClass(e,"btn-disabled"),e.innerHTML=t?"Closed":"Error"}}(this),k.close(e.uid,function(){return t()},function(e,t){return n(e)})}),o={type:"div",cls:"columns",children:[i,p,u?t:null]},s={type:"div",cls:"segment",children:o},w.parseMapForParent(s)},f=function(e,t){return null==t&&(t=30),k.get(e,t,function(){return v.innerHTML=""},function(e,t){var n,r,o,i,c,l,s,d;return e&&t?(o=t.content.jobs,o.length>0?(l=[function(){var e,t,n;for(n=[],e=0,t=o.length;t>e;e++)r=o[e],n.push(b(r));return n}()],s={type:"div",cls:"segments",children:l},w.parseMapForParent(s,v)):(n={type:"h1",cls:"text-thin",title:"No jobs found :("},i={type:"a",href:"/create",title:"create a new job"},d={type:"p",title:"You can ",children:i},w.parseMapForParent(x.blankslate([n,d]),v))):(c=t?""+t.content.msg:"We do not know what happened :(",n="Something went wrong",w.parseMapForParent(x.blankslateWithMsg(n,c),v))})},s=document.getElementById("octohaven-jobs-all"),a=document.getElementById("octohaven-jobs-created"),L=document.getElementById("octohaven-jobs-waiting"),p=document.getElementById("octohaven-jobs-delayed"),E=document.getElementById("octohaven-jobs-running"),h=document.getElementById("octohaven-jobs-finished"),u=document.getElementById("octohaven-jobs-closed"),y=function(){return B.removeClass(s,"selected"),B.removeClass(a,"selected"),B.removeClass(L,"selected"),B.removeClass(p,"selected"),B.removeClass(E,"selected"),B.removeClass(h,"selected"),B.removeClass(u,"selected")},g=function(e){return B.addClass(e,"selected")},l=function(e,t,n){return y(),g(t),"function"==typeof f&&f(n),null!=e&&e.preventDefault(),null!=e?e.stopPropagation():void 0},B.addEventListener(s,"click",function(t){return l(t,s,e)}),B.addEventListener(a,"click",function(e){return l(e,a,n)}),B.addEventListener(L,"click",function(e){return l(e,L,c)}),B.addEventListener(p,"click",function(e){return l(e,p,r)}),B.addEventListener(E,"click",function(e){return l(e,E,i)}),B.addEventListener(h,"click",function(e){return l(e,h,o)}),B.addEventListener(u,"click",function(e){return l(e,u,t)}),l(null,s,e)}).call(this);